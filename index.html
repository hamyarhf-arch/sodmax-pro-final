<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªØ³Øª Ø«Ø¨Øª Ù†Ø§Ù… SODmAX</title>
    <style>
        * { font-family: system-ui; }
        body { background: #0a0f1c; color: white; padding: 20px; }
        .container { max-width: 400px; margin: 50px auto; }
        input, button { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; }
        input { background: #1e293b; border: 1px solid #334155; color: white; }
        button { background: #0066ff; border: none; color: white; font-weight: bold; cursor: pointer; }
        button:hover { background: #0052cc; }
        .success { background: #10b981; padding: 10px; border-radius: 8px; margin: 10px 0; }
        .error { background: #ef4444; padding: 10px; border-radius: 8px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸ¯ ØªØ³Øª Ø«Ø¨Øª Ù†Ø§Ù… SODmAX</h2>
        
        <div id="message"></div>
        
        <input type="email" id="email" placeholder="Ø§ÛŒÙ…ÛŒÙ„" value="test@example.com">
        <input type="password" id="password" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±" value="123456">
        <input type="text" id="fullName" placeholder="Ù†Ø§Ù… Ú©Ø§Ù…Ù„" value="Ú©Ø§Ø±Ø¨Ø± ØªØ³Øª">
        
        <button onclick="register()">Ø«Ø¨Øª Ù†Ø§Ù…</button>
        <button onclick="login()" style="background: #00d4aa;">ÙˆØ±ÙˆØ¯</button>
        <button onclick="mine()" style="background: #ff6b35;">Ø§Ø³ØªØ®Ø±Ø§Ø¬ ØªØ³Øª</button>
        <button onclick="checkUser()" style="background: #8b5cf6;">Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø§Ø±Ø¨Ø±</button>
    </div>

    <script type="module">
        import { simpleRegister, simpleLogin, getSimpleUser, simpleMine, simpleLogout, supabase } from './supabase-client-simple.js'
        
        window.supabase = supabase // Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¨Ø§Ú¯
        
        function showMessage(text, type = 'info') {
            const el = document.getElementById('message')
            el.innerHTML = `<div class="${type}">${text}</div>`
            console.log(type.toUpperCase() + ':', text)
        }
        
        async function register() {
            const email = document.getElementById('email').value
            const password = document.getElementById('password').value
            const fullName = document.getElementById('fullName').value
            
            showMessage('â³ Ø¯Ø± Ø­Ø§Ù„ Ø«Ø¨Øª Ù†Ø§Ù…...', 'info')
            
            const result = await simpleRegister(email, password, fullName)
            
            if (result.success) {
                showMessage('âœ… ' + result.message, 'success')
                console.log('Ú©Ø§Ø±Ø¨Ø± Ø«Ø¨Øª Ø´Ø¯Ù‡:', result.user)
            } else {
                showMessage('âŒ ' + result.error, 'error')
            }
        }
        
        async function login() {
            const email = document.getElementById('email').value
            const password = document.getElementById('password').value
            
            showMessage('â³ Ø¯Ø± Ø­Ø§Ù„ ÙˆØ±ÙˆØ¯...', 'info')
            
            const result = await simpleLogin(email, password)
            
            if (result.success) {
                showMessage('âœ… ' + result.message, 'success')
                console.log('Ú©Ø§Ø±Ø¨Ø± ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡:', result.user)
            } else {
                showMessage('âŒ ' + result.error, 'error')
            }
        }
        
        async function mine() {
            const user = await getSimpleUser()
            
            if (!user) {
                showMessage('âŒ Ø§Ø¨ØªØ¯Ø§ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯', 'error')
                return
            }
            
            showMessage('â›ï¸ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬...', 'info')
            
            const result = await simpleMine(user.id, 100)
            
            if (result.success) {
                showMessage('âœ… ' + result.message, 'success')
            } else {
                showMessage('âŒ ' + result.error, 'error')
            }
        }
        
        async function checkUser() {
            const user = await getSimpleUser()
            
            if (user) {
                showMessage(`ğŸ‘¤ Ú©Ø§Ø±Ø¨Ø± ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡: ${user.email}<br>ID: ${user.id}`, 'success')
                console.log('Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ:', user)
            } else {
                showMessage('âŒ Ù‡ÛŒÚ† Ú©Ø§Ø±Ø¨Ø±ÛŒ ÙˆØ§Ø±Ø¯ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª', 'error')
            }
        }
        
        // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø§ÙˆÙ„ÛŒÙ‡
        supabase.auth.onAuthStateChange((event, session) => {
            console.log('ğŸ”„ ÙˆØ¶Ø¹ÛŒØª Auth ØªØºÛŒÛŒØ± Ú©Ø±Ø¯:', event, session?.user?.email)
        })
        
        console.log('ğŸ® ØªØ³Øª Ø«Ø¨Øª Ù†Ø§Ù… SODmAX Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª')
    </script>
</body>
</html>
